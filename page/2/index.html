<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>FeNJuly&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="next line of code">
<meta property="og:type" content="website">
<meta property="og:title" content="FeNJuly's Blog">
<meta property="og:url" content="http://fenjuly.com/page/2/">
<meta property="og:site_name" content="FeNJuly's Blog">
<meta property="og:description" content="next line of code">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FeNJuly's Blog">
<meta name="twitter:description" content="next line of code">

  
    <link rel="alternative" href="/atom.xml" title="FeNJuly&#39;s Blog" type="application/atom+xml">
  
  
    <link href="/favicon.ico" rel="icon" type="image/x-ico">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">

  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">FeNJuly&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">next line of code</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/About">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="http://www.baidu.com/baidu" method="get" accept-charset="utf-8" class="search-form">
          <input type="search" name="word" maxlength="20" class="search-form-input" placeholder="Search">
          <input type="submit" value="" class="search-form-submit">
          <input name=tn type=hidden value="bds">
          <input name=cl type=hidden value="3">
          <input name=ct type=hidden value="2097152">
          <input type="hidden" name="si" value="fenjuly.com">
        </form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-java-multithread-downloader" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/11/26/java-multithread-downloader/" class="article-date">
  <time datetime="2014-11-26T07:16:15.000Z" itemprop="datePublished">Nov 26 2014</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/11/26/java-multithread-downloader/">Java多线程下载库</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>这几天研究了<a href="https://github.com/daimajia" target="_blank" rel="external">代码家</a>的<a href="https://github.com/daimajia/java-multithread-downloader" target="_blank" rel="external">https://github.com/daimajia/java-multithread-downloader</a>这个多线程下载库。学习到了好多，感谢！</p>
<p>就我的学习而言，有下面几点:</p>
<ul>
<li><p>总体思路:</p>
<p>将文件分为不同的块交给不同的线程去执行。</p>
</li>
<li><p>具体做法:</p>
<p>先按照预先设定的线程数将文件split，假设预先设定了4个线程，这个时候文件就被分为了4块。然后再具体到每一个线程里面：首先判断分到这个线程里的文件块的大小，如果大于一个数(假设为1M)，这个时候再重新split，分出一个小于1M的数据块交给本来的线程下载,同时new一个新的线程去下载剩下的数据块。如此迭代。</p>
</li>
<li><p>细节:</p>
<ul>
<li><p>代码家用了<code>annotation</code>做了断点记录，这样就可以做断点下载。</p>
</li>
<li><p>对速度监控代码家用到了<code>TimerTask</code>和<code>Timer</code>。当新建一个下载任务时调用<code>Timer</code>的 <code>scheduleAtFixedRate(TimerTask task, Date firstTime, long period)</code>这个方法。  </p>
</li>
</ul>
</li>
<li><p>知识整理:</p>
<ul>
<li><p>首先整个库肯定是用线程池实现的。  </p>
</li>
<li><p>为了做断点下载用到了<strong><a href="http://zh.wikipedia.org/wiki/JAXB" target="_blank" rel="external">JAXB</a></strong>技术，就是将Java对象序列化为XML。这里就用到了<code>annotation</code>，在网上看了一篇文章讲得很清楚<a href="http://www.cnblogs.com/fragranting/archive/2012/03/25/xml--jaxb.html" target="_blank" rel="external">Jaxb annotation初步使用</a>。  </p>
</li>
<li><p>为了监控速度和文件的断点下载用到了<code>Timer</code>和<code>TimerTask</code>，同样在网上找了一篇文章也讲得很清楚<a href="http://alanlhy.iteye.com/blog/1168108" target="_blank" rel="external">Java Timer and TimerTask的用法</a>。 </p>
</li>
<li><p>然后由于需要得到下载中的一些信息，用到了<code>Future</code>，也在网上搜了一篇文章<a href="http://www.oschina.net/question/54100_83333#tags_nav" target="_blank" rel="external">java Future用法和意义一句话击破 </a>。</p>
</li>
</ul>
<p>然后，具体的东西还是看代码吧，代码绝对比我说的更清楚。再次感谢代码家。</p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://fenjuly.com/2014/11/26/java-multithread-downloader/" data-id="mtr58le7o4jlylva" class="article-share-link">Share</a>
      

      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-woshibanyungong" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/11/15/woshibanyungong/" class="article-date">
  <time datetime="2014-11-15T07:36:04.000Z" itemprop="datePublished">Nov 15 2014</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/11/15/woshibanyungong/">我是搬运工</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>其实就是这段时间一直在搜集Materail Design的资源，学习并且以备以后开发需要。</p>
<p>然后就发现这个库<a href="https://github.com/futuresimple/android-floating-action-button" target="_blank" rel="external">futuresimple/FloatingActionButton</a>挺不错的。但是他没有这个<a href="https://github.com/makovkastar/FloatingActionButton" target="_blank" rel="external">makovkastar/FloatingActionButton</a>的下滑时隐藏的效果。</p>
<p>然后我就做了一次搬运工，把这个两个结合起来给自己用～</p>
<p>然后我fork了第一个<code>FloatingActionButton</code>，在它的上面改的。。。</p>
<p>然后其实原作者说了这么一句话</p>
<blockquote>
<p>Unlike some other FloatingActionButton libraries this library doesn’t implement “quick return” pattern, i.e. hiding the button on scrolling down and showing it on scrolling up. That’s intentional, I think that should be responsibility of another component, not the button itself.</p>
</blockquote>
<p>我弄完才发现（脸都红了。。。）</p>
<p>所以This’s just for my personal use ！ 哈哈哈。</p>
<p>最后效果图：</p>
<p><img src="http://i.imgur.com/Q2TBeKc.gif" alt="ScreenShot"></p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://fenjuly.com/2014/11/15/woshibanyungong/" data-id="a15b5yohug2o5yim" class="article-share-link">Share</a>
      

      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-xie-liao-yi-ge-jian-dan-de-ji-ri-ji-de-app" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/11/03/xie-liao-yi-ge-jian-dan-de-ji-ri-ji-de-app/" class="article-date">
  <time datetime="2014-11-03T12:34:00.000Z" itemprop="datePublished">Nov 3 2014</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/11/03/xie-liao-yi-ge-jian-dan-de-ji-ri-ji-de-app/">写了一个简单的记日记的app</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>闲来无事又继续android。</p>
<p>这次写了一个记日记的app，并没有别的意思，只是随便找了一个题材。</p>
<p>直接上图。<br><img src="http://i.imgur.com/9U0KJZT.png" alt=""></p>
<p><img src="http://i.imgur.com/K0rmU6G.png" alt=""></p>
<p>然后上传了<a href="http://www.wandoujia.com/apps/com.example.liurongchan.traingdemo" target="_blank" rel="external">豌豆荚</a></p>
<p>照样放在了<a href="https://github.com/fenjuly/SomeDay" target="_blank" rel="external">Github</a>上</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://fenjuly.com/2014/11/03/xie-liao-yi-ge-jian-dan-de-ji-ri-ji-de-app/" data-id="20eivmyjhhwudawf" class="article-share-link">Share</a>
      

      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-xue-xi-bi-ji-fragmentyu-activityjiao-hu" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/10/18/xue-xi-bi-ji-fragmentyu-activityjiao-hu/" class="article-date">
  <time datetime="2014-10-18T05:18:00.000Z" itemprop="datePublished">Oct 18 2014</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/18/xue-xi-bi-ji-fragmentyu-activityjiao-hu/">学习笔记Fragment与Activity交互</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近在看<a href="http://developer.android.com/training/index.html" target="_blank" rel="external">Android Traning</a>，在这里记录一下学习笔记。</p>
<p>然后这里说的是fragment与activityt的交互，一般的做法是在Fragment中定义一个接口。然后activity去实现这个接口。然后framment在<code>onAttach()</code>这中去捕获接口的实现，大概就是这么个过程。</p>
<p>原话是：</p>
<blockquote>
<p>To allow a Fragment to communicate up to its Activity, you can define an interface in the Fragment class and implement it within the Activity. The Fragment captures the interface implementation during its onAttach() lifecycle method and can then call the Interface methods in order to communicate with the Activity.</p>
</blockquote>
<p>然后training给的example：</p>
<pre><code><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeadlinesFragment</span> <span class="keyword">extends</span> <span class="title">ListFragment</span> </span>{
    OnHeadlineSelectedListener mCallback;

    <span class="comment">// Container Activity must implement this interface</span>
    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnHeadlineSelectedListener</span> </span>{
        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onArticleSelected</span>(<span class="keyword">int</span> position);
    }

    <span class="annotation">@Override</span>
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAttach</span>(Activity activity) {
        <span class="keyword">super</span>.onAttach(activity);

        <span class="comment">// This makes sure that the container activity has implemented</span>
        <span class="comment">// the callback interface. If not, it throws an exception</span>
        <span class="keyword">try</span> {
            mCallback = (OnHeadlineSelectedListener) activity;
        } <span class="keyword">catch</span> (ClassCastException e) {
            <span class="keyword">throw</span> <span class="keyword">new</span> ClassCastException(activity.toString()
                    + <span class="string">" must implement OnHeadlineSelectedListener"</span>);
        }
    }

    ...
}
</code></pre><hr>
<pre><code><span class="annotation">@Override</span>
    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onListItemClick</span>(ListView l, View v, <span class="keyword">int</span> position, <span class="keyword">long</span> id)     {
        <span class="comment">// Send the event to the host activity</span>
        mCallback.onArticleSelected(position);
    }
</code></pre><hr>
<pre><code><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span>
    <span class="keyword">implements</span> <span class="title">HeadlinesFragment</span>.<span class="title">OnHeadlineSelectedListener</span></span>{
...

<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onArticleSelected</span>(<span class="keyword">int</span> position) {
    <span class="comment">// The user selected the headline of an article from the HeadlinesFragment</span>
    <span class="comment">// Do something here to display that article</span>
}
}
</code></pre><p>如果activity要传递消息给fragment就太简单了，直接调用fragment的方法。    </p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://fenjuly.com/2014/10/18/xue-xi-bi-ji-fragmentyu-activityjiao-hu/" data-id="1fdkm3fikv9gkpsw" class="article-share-link">Share</a>
      

      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-kai-xue-lai-de-zhuang-tai" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/10/02/kai-xue-lai-de-zhuang-tai/" class="article-date">
  <time datetime="2014-10-02T02:31:00.000Z" itemprop="datePublished">Oct 2 2014</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/02/kai-xue-lai-de-zhuang-tai/">开学来的状态</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>  1.买了个mac mini，从此主力机从x230换成mac mini，同时从linux转到osx</p>
<p>  2.买个了dell u2414h</p>
<p>  3.完成了清水河畔上学期没做完的功能，再次发布出去</p>
<p>  4.研究了<a href="https://github.com/daimajia" target="_blank" rel="external">代码家</a>的开源项目<a href="https://github.com/daimajia/AndroidSwipeLayout" target="_blank" rel="external">AndroisSwipeLayout</a>，给他发了3个pull request但是可惜全部都没有merge，不过确实向他学习了好多，感谢！</p>
<p>  5.状态不够好，感觉每天没有动力写代码了，可能是因为没活干</p>
<p>  6.a little lonely</p>

      
    </div>
    <footer class="article-footer">
      
        <a data-url="http://fenjuly.com/2014/10/02/kai-xue-lai-de-zhuang-tai/" data-id="oa92pc8dd1gy189l" class="article-share-link">Share</a>
      

      

      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Life/">Life</a></li></ul>

    </footer>
  </div>
  
</article>


  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
  
</section>
        
          <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Interview/">Interview</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Life/">Life</a><span class="tag-list-count">8</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 16.67px;">Android</a><a href="/tags/Interview/" style="font-size: 10.00px;">Interview</a><a href="/tags/Java/" style="font-size: 13.33px;">Java</a><a href="/tags/Life/" style="font-size: 20.00px;">Life</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">March 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">January 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">July 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">May 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/09/">September 2013</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2015/08/18/spinnerloader/">这次是一个Loader</a>
          </li>
        
          <li>
            <a href="/2015/07/04/dasanxiaxueqizongjie/">大三下学期总结</a>
          </li>
        
          <li>
            <a href="/2015/03/30/kaixueyigeyuelaidemianshizongjie/">开学一个月的总结</a>
          </li>
        
          <li>
            <a href="/2015/01/13/dasanshangzongjie/">大三上总结</a>
          </li>
        
          <li>
            <a href="/2014/12/18/jinqizuodeshiqing/">近期感想</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Links</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="https://jhat.pw/" target="_blank">Jhat</a>
          </li>
        
          <li>
            <a href="http://徐磊.中国/" target="_blank">xulei</a>
          </li>
        
          <li>
            <a href="http://chenrenyi.cn/" target="_blank">chenrenyi</a>
          </li>
        
          <li>
            <a href="http://liuzechun.cn/" target="_blank">liuzechun</a>
          </li>
        
          <li>
            <a href="http://www.cnblogs.com/echo-yaonie/" target="_blank">hasi</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 FeNJuly<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
      .
      Theme by <a href="https://github.com/xiangming/landscape-plus" target="_blank">Landscape-plus</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/About" class="mobile-nav-link">About</a>
  
</nav>
    

<!-- 百度分享 start -->

<!-- 百度分享 end -->

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>



<! -- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
                processEscapes: true
                    
}
  
        });
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
                  
}
    
        });
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Queue(function() {
            var all = MathJax.Hub.getAllJax(), i;
            for(i=0; i < all.length; i += 1) {
                            all[i].SourceElement().parentNode.className += ' has-jax';
                                    
            }
                
        });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script src="/js/script.js" type="text/javascript"></script>


  </div>
</body>
</html>